<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ø¥Ù„Ù‰ Ø´Ù‡Ø¯ ğŸŒ¹</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,400&family=Tajawal:wght@300;400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
:root{--rose:#e8305a;--rose-deep:#a01040;--rose-glow:rgba(232,48,90,0.45);--gold:#f0c060;--cream:#fff5f0;--ink:#1a0510;--blue:#00aaff;--blue-glow:rgba(0,170,255,0.5);}
html,body{height:100%;overflow:hidden;font-family:'Tajawal',sans-serif;background:#0a0008;color:var(--cream);direction:rtl;}
#canvas{position:fixed;inset:0;z-index:0;pointer-events:none;}

/* INTRO SCREEN */
#introScreen{
  position:fixed;inset:0;z-index:900;
  background:#000;
  display:flex;flex-direction:column;
  align-items:center;justify-content:flex-end;
  padding:0 20px 60px;
  transition:opacity 1.2s ease;
}
#introScreen.hide{opacity:0;pointer-events:none;}
#introByLine{display:none;}

/* Ø²Ø± EXIT */
#exitBtn{
  position:relative;z-index:902;
  background:none;border:none;padding:0;cursor:pointer;
  width:min(120px,30vw);
  opacity:0.75;
  margin-top:12px;
  transition:opacity 0.2s,transform 0.15s;
}
#exitBtn img{width:100%;display:block;}
#exitBtn:active{opacity:0.5;transform:scale(0.92);}

/* EXIT IMAGE POPUP */
#exitPopup{
  position:fixed;inset:0;z-index:950;
  display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,0.75);
  opacity:0;pointer-events:none;
  transition:opacity 0.35s;
}
#exitPopup.show{opacity:1;pointer-events:auto;}
#exitPopup img{
  width:min(85vw,360px);
  border-radius:20px;
  box-shadow:0 0 60px rgba(0,0,0,0.8);
  transform:scale(0.85);
  transition:transform 0.35s cubic-bezier(0.34,1.3,0.64,1);
}
#exitPopup.show img{transform:scale(1);}
#introSlides{
  position:fixed;inset:0;z-index:901;
  background:#000;
}
.slide{
  position:absolute;inset:0;
  background-size:cover;
  background-position:center;
  opacity:0;
  transition:opacity 1.2s ease;
}
.slide.active{opacity:1;}

/* Ø²Ø± START ØµÙˆØ±Ø© */
#starBtn{
  position:relative;z-index:902;
  background:none;border:none;padding:0;cursor:pointer;outline:none;
  width:min(280px,70vw);
  filter:drop-shadow(0 0 18px rgba(200,140,255,0.5));
  animation:starBtnFloat 3s ease-in-out infinite;
  transition:transform 0.1s ease,filter 0.1s ease;
}
#starBtn img{width:100%;display:block;}
#starBtn:active{transform:scale(0.93);filter:drop-shadow(0 0 8px rgba(200,140,255,0.3)) brightness(0.85);}
@keyframes starBtnFloat{0%,100%{transform:translateY(0);}50%{transform:translateY(-6px);}}

/* STAR PARTICLE */
.star-particle{
  position:fixed;pointer-events:none;z-index:910;
  width:4px;height:4px;border-radius:50%;
  background:#cc88ff;box-shadow:0 0 6px 2px rgba(180,100,255,0.8);
  animation:starParticle linear forwards;
}
@keyframes starParticle{0%{transform:translate(0,0) scale(1);opacity:1;}100%{transform:translate(var(--sx),var(--sy)) scale(0);opacity:0;}}

/* DARKNESS */
#darkness{position:fixed;inset:0;z-index:50;background:#000;opacity:0;pointer-events:none;transition:opacity 0.9s cubic-bezier(0.4,0,0.2,1);}

/* APP */
#app{position:relative;z-index:10;height:100dvh;display:flex;align-items:center;justify-content:center;padding:16px;}

/* CARD */
.card{background:rgba(15,2,12,0.92);border:1px solid rgba(255,255,255,0.1);border-radius:32px;width:100%;max-width:400px;text-align:center;box-shadow:0 0 0 1px rgba(232,48,90,0.08),0 24px 80px rgba(0,0,0,0.6),inset 0 1px 0 rgba(255,255,255,0.06);position:relative;overflow:hidden;transition:opacity 1.2s ease,transform 1.2s ease;}
.card::before{content:'';position:absolute;top:0;left:-60%;width:50%;height:100%;background:linear-gradient(105deg,transparent 40%,rgba(255,255,255,0.05) 50%,transparent 60%);animation:shimmer 6s ease-in-out infinite;}
@keyframes shimmer{0%,100%{left:-60%;}50%{left:120%;}}
.card.fading{opacity:0;transform:scale(0.92);}
.card.poem-mode{overflow:visible;}
.card.poem-mode::before{display:none;}

/* PAGES */
.pg{display:none;}
.pg.on{display:block;animation:pageIn 0.55s cubic-bezier(0.34,1.3,0.64,1);}
@keyframes pageIn{from{opacity:0;transform:translateY(18px) scale(0.96);}to{opacity:1;transform:translateY(0) scale(1);}}
#pg1{padding:36px 24px 30px;}
#pg3{padding:30px 22px 36px;height:82dvh;overflow-y:scroll;-webkit-overflow-scrolling:touch;scrollbar-width:thin;scrollbar-color:var(--rose) transparent;}
#pg3::-webkit-scrollbar{width:3px;}
#pg3::-webkit-scrollbar-thumb{background:var(--rose);border-radius:3px;}

/* PROFILE */
.bear-wrap{position:relative;display:inline-block;margin-bottom:16px;}
.bear-ring{position:absolute;inset:-10px;border-radius:50%;border:1.5px dashed rgba(232,48,90,0.4);animation:spin 12s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
.bear{width:145px;height:145px;border-radius:50%;object-fit:cover;border:2px solid rgba(232,48,90,0.3);box-shadow:0 0 30px rgba(232,48,90,0.25),0 0 0 8px rgba(232,48,90,0.05);background:rgba(255,255,255,0.04);display:block;}
.bear-cover{position:absolute;inset:0;border-radius:50%;width:100%;height:100%;object-fit:cover;pointer-events:none;z-index:2;}
.deco-line{display:flex;align-items:center;gap:10px;margin-bottom:12px;justify-content:center;}
.deco-line span{color:var(--gold);font-size:0.68rem;letter-spacing:4px;text-transform:uppercase;opacity:0.7;}
.deco-line::before,.deco-line::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,transparent,rgba(240,192,96,0.4),transparent);max-width:70px;}
.q{font-family:'Playfair Display',serif;font-size:1.65rem;font-style:italic;color:var(--cream);line-height:1.4;margin-bottom:6px;text-shadow:0 2px 20px rgba(232,48,90,0.3);}
.excuse{font-size:0.88rem;color:rgba(240,192,96,0.85);min-height:36px;margin:8px 0 18px;font-weight:400;line-height:1.5;}
.btn-row{display:flex;justify-content:center;gap:14px;min-height:52px;align-items:center;}
.btn{font-family:'Tajawal',sans-serif;font-weight:700;font-size:1.05rem;border:none;border-radius:50px;padding:13px 38px;cursor:pointer;touch-action:manipulation;white-space:nowrap;}
.btn-no{background:transparent;color:var(--rose);border:1.5px solid rgba(232,48,90,0.5);box-shadow:0 4px 14px rgba(232,48,90,0.1);}
@keyframes shakebtn{0%,100%{transform:translateX(0);}20%{transform:translateX(-5px);}40%{transform:translateX(5px);}60%{transform:translateX(-3px);}80%{transform:translateX(3px);}}
.shaking{animation:shakebtn 0.3s ease;}

/* DARK SCENE */
#darkScene{
  position:fixed;inset:0;z-index:200;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  opacity:0;pointer-events:none;
  transition:opacity 1s ease;
  padding:30px 24px;
  gap:28px;
}
#darkScene.visible{opacity:1;pointer-events:auto;}

#darkGif1{width:min(110px,28vw);border-radius:50%;opacity:0;transition:opacity 1s ease;flex-shrink:0;}
#darkGif1.show{opacity:1;}

/* Ø§Ù„Ù†Øµ Ø§Ù„Ø´Ø¹Ø±ÙŠ */
#darkPoem{
  font-family:'Playfair Display',serif;
  font-size:clamp(1.1rem,4.5vw,1.5rem);
  font-style:italic;
  color:rgba(255,245,240,0.97);
  line-height:2;
  text-align:center;
  text-shadow:
    0 0 30px rgba(232,48,90,1),
    0 0 60px rgba(232,48,90,0.5),
    0 2px 10px rgba(0,0,0,0.9);
  direction:rtl;
  min-height:3em;
}

/* Ù†Ø§ÙØ°Ø© Windows */
#winDialog{
  opacity:0;
  transform:scale(0.7) translateY(20px);
  transition:opacity 0.5s ease,transform 0.5s cubic-bezier(0.34,1.4,0.64,1);
  pointer-events:none;
  direction:ltr;
  flex-shrink:0;
}
#winDialog.show{opacity:1;transform:scale(1) translateY(0);pointer-events:auto;}

.win-box{
  background:#ffd6e4;
  border-top:3px solid #fff;
  border-left:3px solid #fff;
  border-right:3px solid #a00050;
  border-bottom:3px solid #a00050;
  font-family:'Share Tech Mono',monospace;
  min-width:230px;max-width:290px;
  image-rendering:pixelated;
}
.win-titlebar{
  background:linear-gradient(90deg,#cc0060,#ff3399,#cc0060);
  padding:4px 6px;
  display:flex;align-items:center;justify-content:space-between;
  color:#fff;font-size:0.75rem;letter-spacing:1px;font-weight:bold;
  border-bottom:2px solid #880044;
  user-select:none;
}
.win-title-text{display:flex;align-items:center;gap:5px;font-size:0.72rem;}
.win-close{
  width:16px;height:16px;
  background:linear-gradient(135deg,#ffaacc,#ff4499);
  border-top:1.5px solid #fff;
  border-left:1.5px solid #fff;
  border-right:1.5px solid #880044;
  border-bottom:1.5px solid #880044;
  color:#440022;font-size:0.6rem;font-weight:900;
  cursor:default;
  display:flex;align-items:center;justify-content:center;
  line-height:1;
}
.win-body{
  padding:16px 14px 12px;
  display:flex;flex-direction:column;align-items:center;gap:14px;
  background:#ffe8f3;
}
.win-content{display:flex;align-items:center;gap:14px;width:100%;}

/* Ù…Ø«Ù„Ø« PixelArt */
.win-triangle-wrap{flex-shrink:0;width:38px;height:38px;position:relative;}
.win-triangle-wrap svg{width:100%;height:100%;}

.win-text-block{display:flex;flex-direction:column;gap:5px;text-align:left;}
.win-msg{font-size:0.9rem;color:#3a0018;font-family:'Share Tech Mono',monospace;letter-spacing:0.5px;font-weight:bold;}
.win-kaomoji{font-size:0.78rem;color:#880044;font-family:'Share Tech Mono',monospace;letter-spacing:1px;}

.win-btn-row{display:flex;justify-content:center;}
.win-btn{
  font-family:'Share Tech Mono',monospace;
  font-size:0.82rem;font-weight:bold;
  padding:5px 32px;
  background:linear-gradient(180deg,#ffd6e4 0%,#ffaac8 100%);
  border-top:2px solid #fff;border-left:2px solid #fff;
  border-right:2px solid #880044;border-bottom:2px solid #880044;
  color:#3a0018;cursor:pointer;
  letter-spacing:2px;text-transform:uppercase;
  touch-action:manipulation;
  transition:filter 0.05s;
  min-width:90px;text-align:center;
}
.win-btn:active{
  border-top:2px solid #880044;border-left:2px solid #880044;
  border-right:2px solid #fff;border-bottom:2px solid #fff;
  filter:brightness(0.9);
}

/* FIREFLIES */
.firefly{position:fixed;width:6px;height:6px;border-radius:50%;background:#aaff88;box-shadow:0 0 8px 3px rgba(160,255,120,0.8);pointer-events:none;animation:fireflyMove linear infinite;}
@keyframes fireflyMove{0%{transform:translate(0,0) scale(1);opacity:0;}20%{opacity:1;}80%{opacity:0.8;}100%{transform:translate(var(--fx),var(--fy)) scale(0.5);opacity:0;}}

/* CURSOR */
.cursor{display:inline-block;width:2px;height:1em;background:var(--rose);margin-right:2px;vertical-align:middle;animation:blink 0.65s step-end infinite;border-radius:1px;}
@keyframes blink{0%,100%{opacity:1;}50%{opacity:0;}}

/* HACKER SCREEN - Ø§Ø®ØªØ±Ø§Ù‚ Ø­Ù‚ÙŠÙ‚ÙŠ */
#hackerScreen{
  position:fixed;inset:0;z-index:400;background:#000;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;
  opacity:0;pointer-events:none;transition:opacity 0.5s ease;
  font-family:'Share Tech Mono',monospace;
}
#hackerScreen.active{opacity:1;pointer-events:auto;}
#hackerBg{position:absolute;inset:0;overflow:hidden;opacity:0.12;pointer-events:none;}
.hacker-col{position:absolute;top:0;font-family:'Share Tech Mono',monospace;font-size:0.7rem;color:#00ff88;animation:hackerFall linear infinite;white-space:nowrap;writing-mode:vertical-lr;letter-spacing:4px;}
@keyframes hackerFall{0%{transform:translateY(-100%);opacity:1;}100%{transform:translateY(100vh);opacity:0;}}

/* terminal box */
#hackerTerminal{
  position:relative;z-index:2;
  width:min(95vw,480px);
  background:rgba(0,10,0,0.95);
  border:1px solid #00ff44;
  border-radius:6px;
  padding:16px 18px;
  box-shadow:0 0 30px rgba(0,255,68,0.15),inset 0 0 20px rgba(0,0,0,0.5);
  max-height:55vh;
  overflow:hidden;
}
.hk-bar{
  display:flex;align-items:center;gap:8px;
  margin-bottom:12px;
  padding-bottom:8px;
  border-bottom:1px solid rgba(0,255,68,0.2);
}
.hk-dot{width:8px;height:8px;border-radius:50%;}
.hk-dot.r{background:#ff5f57;}
.hk-dot.y{background:#febc2e;}
.hk-dot.g{background:#28c840;}
.hk-title{font-size:0.65rem;color:rgba(0,255,68,0.5);letter-spacing:2px;margin-right:auto;}
#termLines{font-size:clamp(0.6rem,2.5vw,0.78rem);color:#00ff44;line-height:1.8;letter-spacing:0.5px;}
.term-line{display:block;white-space:pre-wrap;}
.term-line.red{color:#ff4444;}
.term-line.yellow{color:#ffcc00;}
.term-line.white{color:#eee;}
.term-line.dim{color:rgba(0,255,68,0.4);}

/* BREACHED banner */
#breachBanner{
  position:relative;z-index:3;
  font-size:clamp(1.8rem,8vw,3rem);
  font-weight:900;
  letter-spacing:8px;
  color:#ff0044;
  text-shadow:0 0 20px #ff0044,0 0 60px rgba(255,0,68,0.4);
  opacity:0;
  transform:scale(1.3);
  transition:opacity 0.4s ease,transform 0.4s ease;
  font-family:'Share Tech Mono',monospace;
}
#breachBanner.show{opacity:1;transform:scale(1);}

#hackerPng{width:min(140px,36vw);opacity:0;transition:opacity 1s ease;filter:drop-shadow(0 0 20px rgba(232,48,90,0.7));position:relative;z-index:2;}
#hackerPng.show{opacity:1;}
#hackerText{font-family:'Share Tech Mono',monospace;font-size:clamp(1.2rem,5vw,1.8rem);color:#0f0;text-shadow:0 0 10px #0f0,0 0 30px #0f0;letter-spacing:4px;text-align:center;position:relative;z-index:2;min-height:2rem;}

@keyframes glitch{
  0%,100%{transform:translate(0);}
  20%{transform:translate(-4px,2px);}
  40%{transform:translate(4px,-2px);}
  60%{transform:translate(-3px,3px);}
  80%{transform:translate(3px,-1px);}
}

/* GAME OVER SCREEN */
#gameOverScreen{
  position:fixed;inset:0;z-index:300;
  background:#000;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  opacity:0;pointer-events:none;
  transition:opacity 0.5s ease;
}
#gameOverScreen.active{opacity:1;pointer-events:auto;}
#gameOverText{
  font-family:'Share Tech Mono',monospace;
  font-size:clamp(2.5rem,12vw,5rem);
  font-weight:900;
  color:#ff0000;
  text-shadow:
    0 0 10px #ff0000,
    0 0 30px #ff0000,
    0 0 80px rgba(255,0,0,0.5),
    4px 4px 0 #880000;
  letter-spacing:6px;
  animation:gameOverPulse 0.8s ease-in-out infinite;
}
@keyframes gameOverPulse{
  0%,100%{opacity:1;transform:scale(1);}
  50%{opacity:0.7;transform:scale(1.03);}
}
#gameOverSub{
  font-family:'Share Tech Mono',monospace;
  font-size:clamp(0.7rem,3vw,1rem);
  color:rgba(255,0,0,0.5);
  letter-spacing:4px;
  margin-top:16px;
  animation:blink 1s step-end infinite;
}

/* KALI LINUX SCREEN */
#kaliScreen{
  position:fixed;inset:0;z-index:350;
  background:#1a0a2e;
  display:flex;flex-direction:column;
  opacity:0;pointer-events:none;
  transition:opacity 0.6s ease;
  font-family:'Share Tech Mono',monospace;
  overflow:hidden;
}
#kaliScreen.active{opacity:1;pointer-events:auto;}
.kali-header{
  background:linear-gradient(90deg,#2d1b69,#1a0a2e,#2d1b69);
  padding:6px 16px;
  display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid #4a2d8a;
}
.kali-logo-area{display:flex;align-items:center;gap:10px;}
.kali-dragon{font-size:1.4rem;}
.kali-title-bar{font-size:0.7rem;color:#a070ff;letter-spacing:2px;}
.kali-menu-bar{
  display:flex;gap:16px;padding:4px 16px;
  background:#120820;border-bottom:1px solid #2d1b69;
}
.kali-menu-item{font-size:0.6rem;color:#6040aa;cursor:default;letter-spacing:1px;}
.kali-content{
  flex:1;padding:16px;overflow:hidden;
  display:flex;flex-direction:column;gap:8px;
}
.kali-terminal-header{
  display:flex;align-items:center;gap:8px;
  padding:5px 12px;
  background:#0d0520;
  border-radius:6px 6px 0 0;
  border:1px solid #3d2080;
  border-bottom:none;
}
.kali-dot{width:10px;height:10px;border-radius:50%;}
.kali-dot.r{background:#ff5f57;}
.kali-dot.y{background:#febc2e;}
.kali-dot.g{background:#28c840;}
.kali-term-title{font-size:0.65rem;color:#6040aa;margin-right:auto;letter-spacing:2px;}
.kali-terminal{
  flex:1;
  background:#080215;
  border:1px solid #3d2080;
  border-radius:0 0 6px 6px;
  padding:14px;
  overflow:hidden;
  position:relative;
}
.kali-terminal::before{
  content:'';position:absolute;inset:0;
  background:repeating-linear-gradient(0deg,transparent,transparent 18px,rgba(100,50,200,0.03) 18px,rgba(100,50,200,0.03) 19px);
  pointer-events:none;
}
#kaliLines{font-size:clamp(0.58rem,2.3vw,0.75rem);color:#b090ff;line-height:1.9;letter-spacing:0.3px;}
.kali-line{display:block;}
.kali-line.prompt{color:#8050e0;}
.kali-line.error{color:#ff4466;font-weight:bold;}
.kali-line.warning{color:#ffaa00;}
.kali-line.dim{color:rgba(160,120,255,0.45);}
.kali-line.white{color:#e0d0ff;}
.kali-taskbar{
  background:#120820;
  border-top:1px solid #2d1b69;
  padding:5px 12px;
  display:flex;align-items:center;gap:12px;
  font-size:0.6rem;color:#5030a0;
}
.kali-task-app{
  background:#1d0d40;border:1px solid #3d2080;
  padding:3px 10px;border-radius:3px;
  color:#8060c0;letter-spacing:1px;
}
.kali-clock{margin-right:auto;color:#6040aa;}

/* DANGER BAR */
#dangerBar{
  width:90%;max-width:280px;
  height:6px;
  background:rgba(255,255,255,0.08);
  border-radius:10px;
  margin:4px auto 2px;
  overflow:hidden;
  border:1px solid rgba(232,48,90,0.15);
}
#dangerFill{
  height:100%;width:0%;
  background:linear-gradient(90deg,#ff8800,#ff0044);
  border-radius:10px;
  transition:width 0.5s ease, background 0.5s ease;
  box-shadow:0 0 8px rgba(255,0,68,0.5);
}
#dangerLabel{
  font-size:0.6rem;
  letter-spacing:3px;
  color:rgba(255,68,68,0.6);
  text-transform:uppercase;
  margin-bottom:10px;
  font-family:'Share Tech Mono',monospace;
}
.q-badge{
  display:flex;align-items:center;gap:6px;
  margin-top:14px;
  background:rgba(255,255,255,0.04);
  border:1px solid rgba(232,48,90,0.15);
  border-radius:20px;
  padding:6px 16px;
  font-size:0.68rem;
  color:rgba(240,192,96,0.6);
  letter-spacing:2px;
  font-family:'Share Tech Mono',monospace;
  justify-content:center;
}
.q-badge-icon{font-size:0.8rem;}
/* END DANGER BAR */
.star-fall{position:fixed;pointer-events:none;z-index:60;animation:starDrop linear forwards;opacity:0;}
@keyframes starDrop{0%{transform:translateY(-20px) rotate(0deg);opacity:1;}80%{opacity:0.7;}100%{transform:translateY(105vh) rotate(380deg);opacity:0;}}

/* POEM PAGE */
.poem-eyebrow{font-size:0.68rem;letter-spacing:5px;text-transform:uppercase;color:var(--gold);opacity:0.7;margin-bottom:8px;}
.poem-title{font-family:'Playfair Display',serif;font-size:1.9rem;font-style:italic;color:var(--cream);margin-bottom:4px;text-shadow:0 0 30px rgba(232,48,90,0.4);}
.poem-sub{font-size:0.78rem;color:rgba(240,192,96,0.6);margin-bottom:18px;letter-spacing:1px;}
.poem-video-wrap{position:relative;border-radius:20px;overflow:hidden;margin-bottom:18px;box-shadow:0 8px 40px rgba(232,48,90,0.3);border:1px solid rgba(232,48,90,0.2);}
.poem-video{width:100%;display:block;border-radius:20px;}
.poem-box{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-right:3px solid var(--rose);border-radius:20px;padding:22px 16px;margin-bottom:18px;}
.poem-line{font-family:'Playfair Display',serif;font-size:1.1rem;color:rgba(255,245,240,0.92);line-height:2;font-style:italic;display:block;}
.poem-sep{color:var(--gold);font-size:0.78rem;letter-spacing:8px;margin:8px 0;opacity:0.5;}
.poem-end-img{width:100%;border-radius:20px;margin-top:8px;margin-bottom:20px;display:block;box-shadow:0 8px 30px rgba(232,48,90,0.25);border:1px solid rgba(232,48,90,0.15);}
.poem-seal{background:linear-gradient(135deg,var(--rose),var(--rose-deep));border-radius:16px;padding:14px 20px;color:white;font-size:1rem;font-weight:700;letter-spacing:1px;box-shadow:0 8px 30px rgba(232,48,90,0.4);margin-bottom:20px;}
.scroll-hint{color:var(--rose);font-size:1.2rem;opacity:0.5;animation:bounce 1.4s ease-in-out infinite;}
@keyframes bounce{0%,100%{transform:translateY(0);}50%{transform:translateY(6px);}}

/* THE END BUTTON */
#theEndBtn{
  display:block;
  margin:10px auto 28px;
  font-family:'Playfair Display',serif;
  font-size:1.15rem;
  font-style:italic;
  color:#fff;
  background:linear-gradient(135deg,var(--rose),var(--rose-deep));
  border:none;
  border-radius:50px;
  cursor:pointer;
  letter-spacing:2px;
  padding:14px 34px;
  box-shadow:0 0 22px rgba(232,48,90,0.55), 0 4px 18px rgba(0,0,0,0.35);
  animation:endBtnPulse 2s ease-in-out infinite;
  touch-action:manipulation;
}
@keyframes endBtnPulse{
  0%,100%{box-shadow:0 0 22px rgba(232,48,90,0.55),0 4px 18px rgba(0,0,0,0.35);}
  50%{box-shadow:0 0 40px rgba(232,48,90,0.9),0 4px 28px rgba(0,0,0,0.4);}
}
#theEndBtn:active{transform:scale(0.95);}
#endBtnHint{
  display:block;
  text-align:center;
  font-size:0.72rem;
  color:rgba(240,192,96,0.7);
  letter-spacing:3px;
  margin-bottom:6px;
  animation:bounce 1.4s ease-in-out infinite;
  font-family:'Share Tech Mono',monospace;
}

/* END SCREEN - removed (replaced by endUniverse) */

/* Ø®ÙŠÙˆØ· + ØµÙˆØ±Ø© Ù…Ø¹Ù„Ù‚Ø© */
.end-hanger{
  position:absolute;
  top:0;
  left:50%;
  transform:translateX(-50%);
  z-index:502;
  display:flex;flex-direction:column;
  align-items:center;
  animation:swing 3.5s ease-in-out infinite;
  transform-origin:top center;
  opacity:0;transition:opacity 1s ease;
}
.end-hanger.show{opacity:1;}
@keyframes swing{
  0%,100%{transform:translateX(-50%) rotate(-5deg);}
  50%{transform:translateX(-50%) rotate(5deg);}
}

/* Ø®ÙŠÙˆØ· Ø°Ù‡Ø¨ÙŠØ© */
.threads{
  display:flex;gap:60px;
  height:60px;
  align-items:flex-start;
}
.thread{
  width:1.5px;
  height:60px;
  background:linear-gradient(to bottom,rgba(240,192,96,0.9),rgba(240,192,96,0.3));
  box-shadow:0 0 4px rgba(240,192,96,0.6);
}

/* Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¹ Ø§Ù„Ù†Øµ Ø¯Ø§Ø®Ù„Ù‡Ø§ */
.end-img-wrap{
  position:relative;
  width:min(220px,58vw);
  border-radius:20px;
  overflow:hidden;
  box-shadow:
    0 0 0 2px rgba(240,192,96,0.5),
    0 0 0 4px rgba(240,192,96,0.2),
    0 8px 40px rgba(0,0,0,0.6);
}
.end-img-wrap img{
  width:100%;display:block;border-radius:20px;
}
.end-img-caption{
  position:absolute;bottom:18%;left:0;right:0;
  padding:20px 14px 16px;
  background:linear-gradient(to top,rgba(0,0,0,0.85) 0%,transparent 100%);
  font-family:'Playfair Display',serif;
  font-size:clamp(0.75rem,3.2vw,0.95rem);
  font-style:italic;
  color:rgba(255,245,240,0.97);
  line-height:1.8;
  text-align:center;
  direction:rtl;
  text-shadow:0 1px 6px rgba(0,0,0,0.9);
  letter-spacing:0.5px;
}
.end-below-text{
  margin-top:18px;
  font-family:'Playfair Display',serif;
  font-size:clamp(0.9rem,4vw,1.2rem);
  font-style:italic;
  color:rgba(255,245,240,0.9);
  text-align:center;
  direction:rtl;
  line-height:1.9;
  text-shadow:0 0 20px rgba(232,48,90,0.6),0 2px 8px rgba(0,0,0,0.9);
  letter-spacing:1px;
  position:relative;z-index:502;
}

/* â•â•â•â•â•â•â• ENDING UNIVERSE â•â•â•â•â•â•â• */
#endUniverse{position:fixed;inset:0;z-index:600;display:none;}
#endUniverse.active{display:block;}
#endBlack{position:absolute;inset:0;background:#000;z-index:1;opacity:0;transition:opacity 1.2s ease;}
#endBlack.show{opacity:1;}

/* ERROR POPUPS */
#errorContainer{position:absolute;inset:0;z-index:5;pointer-events:none;}
.err-pop{
  position:absolute;
  font-family:'Share Tech Mono',monospace;
  min-width:200px;max-width:260px;
  animation:errPop 0.25s cubic-bezier(0.34,1.6,0.64,1);
  pointer-events:none;
  filter:drop-shadow(0 4px 16px rgba(0,0,0,0.7));
}
@keyframes errPop{from{transform:scale(0.5) translateY(20px);opacity:0;}to{transform:scale(1) translateY(0);opacity:1;}}
.err-bar{
  background:linear-gradient(90deg,#000080,#1084d0,#000080);
  padding:3px 6px;display:flex;align-items:center;justify-content:space-between;
  color:#fff;font-size:0.7rem;font-weight:bold;letter-spacing:1px;
}
.err-bar-btns{display:flex;gap:2px;}
.err-bar-btn{
  width:14px;height:12px;background:#c0c0c0;
  border-top:1px solid #fff;border-left:1px solid #fff;
  border-right:1px solid #404040;border-bottom:1px solid #404040;
  font-size:0.55rem;color:#000;display:flex;align-items:center;justify-content:center;
}
.err-body{
  background:#c0c0c0;
  border-top:2px solid #fff;border-left:2px solid #fff;
  border-right:2px solid #404040;border-bottom:2px solid #404040;
  padding:12px 10px 10px;display:flex;flex-direction:column;align-items:center;gap:8px;
}
.err-row{display:flex;align-items:flex-start;gap:10px;width:100%;}
.err-icon{font-size:1.8rem;flex-shrink:0;line-height:1;}
.err-txt{font-size:0.68rem;color:#000;line-height:1.6;}
.err-ok{
  font-family:'Share Tech Mono',monospace;font-size:0.72rem;font-weight:bold;
  padding:3px 24px;
  background:#c0c0c0;
  border-top:2px solid #fff;border-left:2px solid #fff;
  border-right:2px solid #404040;border-bottom:2px solid #404040;
  color:#000;cursor:default;letter-spacing:1px;
}

/* LOVE POPUP */
#lovePop{
  position:absolute;inset:0;z-index:20;
  display:flex!important;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity 0.5s ease;
}
#lovePop.show{opacity:1;pointer-events:auto;}
.lp-box{
  background:#ffd6e4;
  border-top:3px solid #fff;border-left:3px solid #fff;
  border-right:3px solid #a00050;border-bottom:3px solid #a00050;
  font-family:'Share Tech Mono',monospace;
  min-width:240px;max-width:300px;
  animation:lpPop 0.35s cubic-bezier(0.34,1.5,0.64,1);
}
@keyframes lpPop{from{transform:scale(0.6);}to{transform:scale(1);}}
.lp-title{
  background:linear-gradient(90deg,#cc0060,#ff3399,#cc0060);
  padding:4px 8px;display:flex;align-items:center;justify-content:space-between;
  color:#fff;font-size:0.75rem;letter-spacing:1px;font-weight:bold;user-select:none;
}
.lp-close{
  width:16px;height:16px;
  background:linear-gradient(135deg,#ffaacc,#ff4499);
  border-top:1.5px solid #fff;border-left:1.5px solid #fff;
  border-right:1.5px solid #880044;border-bottom:1.5px solid #880044;
  color:#440022;font-size:0.65rem;font-weight:900;
  display:flex;align-items:center;justify-content:center;
}
.lp-body{padding:16px 14px 14px;background:#ffe8f3;display:flex;flex-direction:column;gap:14px;align-items:center;}
.lp-content{display:flex;align-items:center;gap:14px;width:100%;}
.lp-tri{width:36px;height:36px;flex-shrink:0;}
.lp-tri svg{width:100%;height:100%;}
.lp-text{display:flex;flex-direction:column;gap:4px;}
.lp-msg{font-size:0.95rem;color:#3a0018;font-family:'Share Tech Mono',monospace;font-weight:bold;}
.lp-kao{font-size:0.8rem;color:#880044;font-family:'Share Tech Mono',monospace;}
.lp-btns{display:flex;gap:10px;justify-content:center;}
.lp-btn{
  font-family:'Share Tech Mono',monospace;font-size:0.82rem;font-weight:bold;
  padding:5px 28px;
  background:linear-gradient(180deg,#ffd6e4,#ffaac8);
  border-top:2px solid #fff;border-left:2px solid #fff;
  border-right:2px solid #880044;border-bottom:2px solid #880044;
  color:#3a0018;cursor:pointer;letter-spacing:2px;min-width:80px;text-align:center;
  touch-action:manipulation;transition:opacity 0.3s,transform 0.3s;
}
.lp-btn:active{border-top:2px solid #880044;border-left:2px solid #880044;border-right:2px solid #fff;border-bottom:2px solid #fff;}
.lp-no.hide{opacity:0!important;pointer-events:none!important;transform:scale(0.5);}

/* HACKER MSG */
#hackMsg{
  position:absolute;inset:0;z-index:25;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:14px;
  font-family:'Share Tech Mono',monospace;
  letter-spacing:5px;text-align:center;
  opacity:0;pointer-events:none;
  padding:24px;
}
#hackMsg.show{opacity:1;}
#hmMain{
  font-size:clamp(1.3rem,5.5vw,2.2rem);
  color:#0ff;
  text-shadow:0 0 8px #0ff,0 0 25px #0ff,0 0 60px rgba(0,255,255,0.5);
  line-height:1.6;
  min-height:2.5rem;
}
#hmSub{
  font-size:clamp(0.7rem,2.8vw,0.9rem);
  color:rgba(0,200,255,0.5);
  letter-spacing:4px;
  animation:blink 1s step-end infinite;
}

/* FINAL VIDEO */
#finalVid{
  position:absolute;inset:0;width:100%;height:100%;
  object-fit:cover;z-index:30;
  opacity:0;transition:opacity 1.5s ease;
  pointer-events:none;
}
#finalVid.show{opacity:1;}
/* FLIP SCREEN */
#flipScreen{
  position:absolute;inset:0;z-index:28;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:20px;
  opacity:0;pointer-events:none;
  transition:opacity 1s ease;
}
#flipScreen.show{opacity:1;}
#flipPhone{
  font-size:4rem;
  animation:flipAnim 1.2s ease-in-out infinite;
}
@keyframes flipAnim{
  0%{transform:rotate(0deg);}
  40%{transform:rotate(90deg);}
  60%{transform:rotate(90deg);}
  100%{transform:rotate(90deg) scale(1.05);}
}
#flipTxt{
  font-family:'Playfair Display',serif;
  font-size:clamp(1rem,4.5vw,1.5rem);
  font-style:italic;
  color:rgba(255,245,240,0.92);
  text-align:center;
  direction:rtl;
  text-shadow:0 0 20px rgba(232,48,90,0.6);
  letter-spacing:1px;
  line-height:1.8;
}
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
</style>
<body>
<canvas id="canvas"></canvas>

<audio id="introSong" src="https://files.catbox.moe/4mmfyj.mp4" loop></audio>
<audio id="gameSong" src="https://files.catbox.moe/avuhx7.mp3" loop></audio>

<!-- INTRO -->
<div id="introScreen">
  <div id="introByLine">By Yamada KJ</div>
  <div id="introSlides">
    <div class="slide active" style="background-image:url('https://i.ibb.co/LDn2PC2N/image-0.jpg')"></div>
    <div class="slide" style="background-image:url('https://i.ibb.co/JWq7Gbbr/image-1.jpg')"></div>
    <div class="slide" style="background-image:url('https://i.ibb.co/Sw4vXdcD/image-2.jpg')"></div>
    <div class="slide" style="background-image:url('https://i.ibb.co/jZ9MCtcJ/image-3.jpg')"></div>
    <div class="slide" style="background-image:url('https://i.ibb.co/pNwqbMH/image-4.jpg')"></div>
    <div class="slide" style="background-image:url('https://i.ibb.co/jcWd74k/image-5.jpg')"></div>
  </div>
  <button id="starBtn">
    <img src="https://i.ibb.co/0VsQ7GnM/image-0.png" alt="START">
  </button>
  <button id="exitBtn">
    <img src="https://i.ibb.co/v6csbLdc/image-0.png" alt="Exit">
  </button>
</div>

<!-- EXIT IMAGE POPUP -->
<div id="exitPopup">
  <img src="https://i.ibb.co/XryyNcMn/image-0.png" alt="">
</div>

<div id="darkness"></div>

<!-- DARK SCENE -->
<div id="darkScene">
  <img id="darkGif1" src="https://i.ibb.co/3m04CmKp/image-0.gif" alt="">
  <div id="darkPoem"></div>

  <!-- Ù†Ø§ÙØ°Ø© Windows -->
  <div id="winDialog">
    <div class="win-box">
      <div class="win-titlebar">
        <div class="win-title-text">
          <span>ğŸ’Œ</span>
          <span>Desktop</span>
        </div>
        <div class="win-close">âœ•</div>
      </div>
      <div class="win-body">
        <div class="win-content">
          <!-- Ù…Ø«Ù„Ø« SVG PixelArt -->
          <div class="win-triangle-wrap">
            <svg viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
              <polygon points="19,3 36,34 2,34" fill="#e0006a" stroke="#880044" stroke-width="2"/>
              <text x="19" y="30" text-anchor="middle" font-family="monospace" font-size="16" font-weight="900" fill="white">!</text>
            </svg>
          </div>
          <div class="win-text-block">
            <div class="win-msg">Do you love me?</div>
            <div class="win-kaomoji">Ê•(@^â–½^@)Ê”</div>
          </div>
        </div>
        <div class="win-btn-row">
          <button class="win-btn" id="darkYesBtn">Yes</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- GAME OVER SCREEN -->
<div id="gameOverScreen">
  <div id="gameOverText">GAME OVER</div>
  <div id="gameOverSub">INSERT COIN TO CONTINUE...</div>
</div>

<!-- KALI LINUX SCREEN -->
<div id="kaliScreen">
  <div class="kali-header">
    <div class="kali-logo-area">
      <span class="kali-dragon">ğŸ‰</span>
      <span class="kali-title-bar">KALI LINUX â€” root@kali:~</span>
    </div>
    <span style="font-size:0.6rem;color:#5030a0;">GNU/Linux 6.1.0</span>
  </div>
  <div class="kali-menu-bar">
    <span class="kali-menu-item">File</span>
    <span class="kali-menu-item">Edit</span>
    <span class="kali-menu-item">View</span>
    <span class="kali-menu-item">Terminal</span>
    <span class="kali-menu-item">Help</span>
  </div>
  <div class="kali-content">
    <div class="kali-terminal-header">
      <div class="kali-dot r"></div>
      <div class="kali-dot y"></div>
      <div class="kali-dot g"></div>
      <span class="kali-term-title">terminal â€” root@kali â€” 80Ã—24</span>
    </div>
    <div class="kali-terminal">
      <div id="kaliLines"></div>
    </div>
  </div>
  <div class="kali-taskbar">
    <span class="kali-task-app">ğŸ‰ Kali</span>
    <span class="kali-task-app">âš™ Terminal</span>
    <span class="kali-clock" id="kaliClock">--:--</span>
  </div>
</div>

<!-- HACKER SCREEN -->
<div id="hackerScreen">
  <div id="hackerBg"></div>
  <div id="hackerTerminal">
    <div class="hk-bar">
      <div class="hk-dot r"></div>
      <div class="hk-dot y"></div>
      <div class="hk-dot g"></div>
      <div class="hk-title">YAMADA_BREACH_v2.exe</div>
    </div>
    <div id="termLines"></div>
  </div>
  <div id="breachBanner">âš  ACCESS GRANTED âš </div>
  <img id="hackerPng" src="https://i.ibb.co/99jMm5fb/image-0.png" alt="">
  <div id="hackerText"></div>
</div>

<div id="app">
  <div class="card" id="mainCard">
    <div class="pg on" id="pg1">
      <div class="bear-wrap">
        <div class="bear-ring"></div>
        <img class="bear" src="https://i.ibb.co/jKJZ7Vk/image-0.jpg" alt="profile">
        <img class="bear-cover" src="https://i.ibb.co/NgcwWsQg/image-0.png" alt="cover">
      </div>
      <div class="deco-line"><span>Ù…Ù„Ù Ø³Ø±ÙŠ âœ¦ Ø´Ù‡Ø¯</span></div>
      <div class="q" style="font-size:1.35rem;">Ù‡Ù„ ØªØ¶Ù†ÙŠÙ† Ø£Ù† ÙŠØ§Ù…Ø§Ø¯Ø§ ÙŠØ­Ø¨ÙƒÙØŸ ğŸ’œ</div>
      <div class="excuse" id="excuseText" style="font-size:0.85rem;color:rgba(240,192,96,0.9);">Ø£Ø¬ÙŠØ¨ÙŠ Ø¨ØµØ¯Ù‚ ÙŠØ§ Ø´Ù‡Ø¯..</div>

      <!-- Ù…Ø¤Ø´Ø± Ø§Ù„Ø®Ø·Ø± -->
      <div id="dangerBar">
        <div id="dangerFill"></div>
      </div>
      <div id="dangerLabel">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·Ø±: <span id="dangerPct">0%</span></div>

      <div class="btn-row">
        <button class="btn btn-no" id="noBtn">Ù„Ø§ ğŸ¥º</button>
      </div>

      <!-- Ø´Ø§Ø±Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ -->
      <div class="q-badge">
        <span class="q-badge-icon">ğŸ”</span>
        <span class="q-badge-txt">Ø³Ø¤Ø§Ù„ Ø±Ù‚Ù… <span id="qNum">Ù¡</span> Ù…Ù† Ù¤Ù </span>
      </div>
    </div>

    <div class="pg" id="pg3">
      <div class="poem-eyebrow">âœ¦ Ù…Ù† ÙŠØ§Ù…Ø§Ø¯Ø§ Ø¥Ù„Ù‰ Ø´Ù‡Ø¯ âœ¦</div>
      <div class="poem-title">Ø¥Ù„Ù‰ Ø´Ù‡Ø¯..</div>
      <div class="poem-sub">Ø¨Ù‚Ù„Ù… ÙŠØ§Ù…Ø§Ø¯Ø§ Ø§Ù„Ù…Ø­Ø¨ ğŸŒ¹</div>
      <div class="poem-video-wrap">
        <video id="poemVideo" class="poem-video" loop muted playsinline preload="none" src="https://files.catbox.moe/zlwyvw.mp4"></video>
      </div>
      <div class="poem-box">
        <span class="poem-line">ÙŠØ§ Ø´Ù‡Ø¯Ù ÙŠØ§ Ø³ÙÙƒÙ‘Ø± Ø§Ù„Ø£ÙŠØ§Ù…Ù ÙÙŠ Ø¹ÙŠÙ†ÙŠ</span>
        <span class="poem-line">ÙˆÙŠØ§ Ù†Ø´ÙŠØ¯Ø§Ù‹ Ø¨Ù‚Ù„Ø¨ÙŠ Ø¹Ø²ÙÙ‡Ù Ø´Ø¬ÙÙ†Ù</span>
        <span class="poem-sep">âœ¦ âœ¦ âœ¦</span>
        <span class="poem-line">Ù…Ø§ Ù‚ÙŠÙ…Ø©Ù Ø§Ù„Ø¹Ù…Ø±Ù Ù„Ùˆ Ù„ÙÙ… ØªØ³ÙƒÙ†ÙŠ Ù…Ø¯Ù†ÙŠØŸ</span>
        <span class="poem-line">Ø£Ù†ØªÙ Ø§Ù„Ù…Ù„Ø§Ø°Ù ÙˆØ£Ù†ØªÙ Ø§Ù„Ø±ÙˆØ­Ù ÙˆØ§Ù„ÙˆØ·Ù†Ù</span>
        <span class="poem-sep">ğŸŒ¹ ğŸŒ¹ ğŸŒ¹</span>
        <span class="poem-line">Ø£Ø­Ø¨ÙƒÙ Ø­Ø¨Ø§Ù‹ Ù„Ùˆ ÙˆØ²Ø¹ØªÙÙ‡Ù Ø¨ÙØ­Ø±Ø§Ù‹</span>
        <span class="poem-line">Ù„ØµØ§Ø±Ù Ø´Ù‡Ø¯Ø§Ù‹ ÙˆØ°Ø§Ø¨Ù Ø¨Ù…Ù„Ø­Ù‡Ù Ø§Ù„Ø­ÙØ²ÙÙ†Ù</span>
        <span class="poem-sep">âœ¦ âœ¦ âœ¦</span>
        <span class="poem-line">Ø£Ù†ØªÙ Ø§Ù„ÙØ¬Ø±Ù Ø­ÙŠÙ† ÙŠÙØ´Ø±Ù‚Ù ÙÙŠ Ø¯ÙØ¬Ù‰</span>
        <span class="poem-line">ÙˆØ£Ù†ØªÙ Ø§Ù„Ù†Ø¬Ù…Ù Ø­ÙŠÙ† ÙŠØºÙŠØ¨Ù Ø§Ù„Ù‚Ù…Ø±Ù</span>
        <span class="poem-sep">ğŸŒ¸ ğŸŒ¸ ğŸŒ¸</span>
        <span class="poem-line">Ù„Ùˆ Ø£Ù†Ù‘ Ø§Ù„ÙƒÙ„Ø§Ù…Ù ÙŠÙˆÙÙŠ Ù…Ø§ ØªØ³ØªØ­Ù‚ÙŠÙ†</span>
        <span class="poem-line">Ù„ÙƒØªØ¨ØªÙ Ù„ÙƒÙ Ù…Ø§ Ù„Ù… ØªÙƒØªØ¨Ù‡Ù Ø§Ù„Ø¨Ø­ÙˆØ±Ù</span>
        <span class="poem-sep">âœ¦ âœ¦ âœ¦</span>
        <span class="poem-line">ÙƒÙ„ÙÙ‘ Ù…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ù ÙŠØ´Ù‡Ø¯Ù Ø£Ù†Ù‘Ù†ÙŠ</span>
        <span class="poem-line">Ø£Ø­Ø¨ÙÙ‘ÙƒÙ Ø­ÙØ¨Ù‘Ø§Ù‹ Ù„Ø§ ÙŠÙÙ‚Ø§Ø³Ù ÙˆÙ„Ø§ ÙŠÙØ­ØµØ±Ù</span>
        <span class="poem-sep">ğŸ’« ğŸ’« ğŸ’«</span>
        <span class="poem-line">ÙŠØ§ Ø´Ù‡Ø¯Ù.. Ø£Ù†ØªÙ Ø§Ù„Ù‚ØµÙŠØ¯Ø©Ù ÙˆØ§Ù„Ù‚ØµÙ‘Ø§Ø¯Ù</span>
        <span class="poem-line">ÙˆØ£Ù†ØªÙ Ø§Ù„Ø­Ø±ÙˆÙÙ Ø­ÙŠÙ† ØªØ¹Ø¬Ø²Ù Ø§Ù„Ø£Ø¨Ø¬Ø¯Ù</span>
      </div>
      <img class="poem-end-img" src="https://i.ibb.co/hxdBkf3P/image-0.jpg" alt="">
      <div class="poem-seal">Ø£Ø­Ø¨ÙƒÙ Ù„Ù„Ø£Ø¨Ø¯ â™¾ï¸</div>
      <div class="scroll-hint">â–¼</div>
      <span id="endBtnHint">âœ¦ Ø§Ø¶ØºØ·ÙŠ Ù‡Ù†Ø§ âœ¦</span>
      <button id="theEndBtn">ğŸ’Œ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</button>
    </div>
  </div>
</div>

<!-- NEW ENDING -->
<div id="endUniverse">
  <div id="endBlack"></div>
  <!-- error popups container -->
  <div id="errorContainer"></div>
  <!-- final love popup -->
  <div id="lovePop" style="display:none">
    <div class="lp-box">
      <div class="lp-title"><span>ğŸ’Œ Desktop</span><div class="lp-close">âœ•</div></div>
      <div class="lp-body">
        <div class="lp-content">
          <div class="lp-tri"><svg viewBox="0 0 38 38"><polygon points="19,3 36,34 2,34" fill="#e0006a" stroke="#880044" stroke-width="2"/><text x="19" y="30" text-anchor="middle" font-family="monospace" font-size="16" font-weight="900" fill="white">!</text></svg></div>
          <div class="lp-text"><div class="lp-msg">Do you love me?</div><div class="lp-kao">Ê•(@^â–½^@)Ê”</div></div>
        </div>
        <div class="lp-btns">
          <button class="lp-btn" id="lpYes">Yes</button>
          <button class="lp-btn lp-no" id="lpNo">No</button>
        </div>
      </div>
    </div>
  </div>
  <!-- hacker text -->
  <div id="hackMsg"><div id="hmMain"></div><div id="hmSub">[ ACCESS_GRANTED ]</div></div>
  <!-- flip screen -->
  <div id="flipScreen">
    <div id="flipPhone">ğŸ“±</div>
    <div id="flipTxt">Ø§Ù‚Ù„Ø¨ÙŠ Ø§Ù„Ø´Ø§Ø´Ø©<br>Ù„Ù„Ø£ÙÙ‚ÙŠ ğŸŒ¹</div>
  </div>
  <!-- final video -->
  <video id="finalVid" loop playsinline preload="none" src="https://files.catbox.moe/9uawje.mp4"></video>
</div>

<script>
const canvas=document.getElementById('canvas'),ctx=canvas.getContext('2d');
let W,H;
function resize(){W=canvas.width=window.innerWidth;H=canvas.height=window.innerHeight;}
resize();window.addEventListener('resize',resize);
const EMOJIS=['â¤ï¸','ğŸ’•','âœ¨','ğŸŒ¸'];
class Pt{
  constructor(init){this.x=Math.random()*(W||400);this.y=init?Math.random()*(H||800):(H||800)+20;this.size=10+Math.random()*12;this.spd=0.3+Math.random()*0.5;this.drift=(Math.random()-0.5)*0.25;this.op=0.2+Math.random()*0.35;this.ch=EMOJIS[Math.floor(Math.random()*EMOJIS.length)];}
  tick(){this.y-=this.spd;this.x+=this.drift;if(this.y<-30){this.y=H+20;this.x=Math.random()*W;}}
  draw(){ctx.globalAlpha=this.op;ctx.font=this.size+'px serif';ctx.fillText(this.ch,this.x,this.y);}
}
const pts=Array.from({length:10},(_,i)=>new Pt(true));
let canvasVisible=true;
let introActive=true; // Ø§Ù„Ù€ canvas Ù…Ùˆ Ù…Ø±Ø¦ÙŠ ÙˆØ±Ø§Ø¡ Ø§Ù„Ù€ slideshow
document.addEventListener('visibilitychange',()=>{canvasVisible=!document.hidden;});
(function loop(){
  if(canvasVisible && !introActive){ctx.clearRect(0,0,W,H);pts.forEach(p=>{p.tick();p.draw();});}
  requestAnimationFrame(loop);
})();

const introScreen=document.getElementById('introScreen');
const starBtn=document.getElementById('starBtn');
const introSong=document.getElementById('introSong');
const gameSong=document.getElementById('gameSong');
const noBtn=document.getElementById('noBtn');
const excuse=document.getElementById('excuseText');
const darkness=document.getElementById('darkness');
const mainCard=document.getElementById('mainCard');
const darkScene=document.getElementById('darkScene');
const darkGif1=document.getElementById('darkGif1');
const darkPoem=document.getElementById('darkPoem');
const winDialog=document.getElementById('winDialog');
const darkYesBtn=document.getElementById('darkYesBtn');

/* EXIT â†’ IMAGE */
const exitPopup = document.getElementById('exitPopup');
document.getElementById('exitBtn').addEventListener('click', ()=>{
  exitPopup.classList.add('show');
});
exitPopup.addEventListener('click', ()=>{
  exitPopup.classList.remove('show');
});
const hackerScreen=document.getElementById('hackerScreen');
const hackerPng=document.getElementById('hackerPng');
const hackerText=document.getElementById('hackerText');
const hackerBg=document.getElementById('hackerBg');

const MAX_NO=40;
let noCount=0,darkPhase=false,gameOver=false;

/* â”€â”€ SLIDESHOW â”€â”€ */
const slides = document.querySelectorAll('.slide');
let slideIdx = 0;
function nextSlide(){
  slides[slideIdx].classList.remove('active');
  slideIdx = (slideIdx + 1) % slides.length;
  slides[slideIdx].classList.add('active');
}
// ÙƒÙ„ Ø«Ø§Ù†ÙŠØªÙŠÙ† ØªØªØºÙŠØ±
let slideTimer = setInterval(nextSlide, 2000);
// Ø£Ùˆ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© (Ø¨Ø³ Ù…Ø´ Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±)
document.getElementById('introSlides').addEventListener('click', ()=>{
  clearInterval(slideTimer);
  nextSlide();
  slideTimer = setInterval(nextSlide, 2000);
});

/* â”€â”€ ØªØ´ØºÙŠÙ„ Ø£ØºÙ†ÙŠØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙÙˆØ± Ø£ÙˆÙ„ ØªÙØ§Ø¹Ù„ â”€â”€ */
let introStarted = false;
function tryStartIntro(){
  if(introStarted) return;
  introStarted = true;
  introSong.volume = 1;
  introSong.play().catch(()=>{});
}
document.addEventListener('touchstart', tryStartIntro, {once:true});
document.addEventListener('click', tryStartIntro, {once:true});

starBtn.addEventListener('click',e=>{
  tryStartIntro(); // fallback Ù„Ùˆ Ù…Ø§ Ø§Ø´ØªØºÙ„Øª Ù‚Ø¨Ù„
  clearInterval(slideTimer); // ÙˆÙ‚Ù‘Ù Ø§Ù„Ù€ slideshow
  const rect=starBtn.getBoundingClientRect();
  const cx=rect.left+rect.width/2,cy=rect.top+rect.height/2;
  for(let i=0;i<24;i++){
    const p=document.createElement('div');p.className='star-particle';
    const angle=(i/24)*Math.PI*2,dist=60+Math.random()*100;
    p.style.setProperty('--sx',Math.cos(angle)*dist+'px');
    p.style.setProperty('--sy',Math.sin(angle)*dist+'px');
    p.style.left=cx+'px';p.style.top=cy+'px';
    p.style.animationDuration=(0.6+Math.random()*0.5)+'s';
    document.body.appendChild(p);setTimeout(()=>p.remove(),1200);
  }
  setTimeout(()=>{
    introScreen.classList.add('hide');
    // Ø£ØºÙ†ÙŠØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ØªØªÙ„Ø§Ø´Ù‰
    fadeAudio(introSong,introSong.volume,0,2000);
    // Ø£ØºÙ†ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØ¨Ø¯Ø£
    gameSong.volume=0;gameSong.play().catch(()=>{});
    fadeAudio(gameSong,0,1,2500);
  },600);
  setTimeout(()=>{introScreen.style.display='none'; introActive=false;},1900);
});

function fadeAudio(audio,from,to,duration){
  audio.volume=from;
  const steps=40,stepTime=duration/steps,stepVal=(to-from)/steps;
  let count=0;
  const iv=setInterval(()=>{
    count++;audio.volume=Math.max(0,Math.min(1,from+stepVal*count));
    if(count>=steps){audio.volume=to;clearInterval(iv);if(to===0)audio.pause();}
  },stepTime);
}

const STARS=['âœ¨','â­','ğŸŒŸ','ğŸ’«','ğŸŒ¸'];
function spawnStars(n){
  for(let i=0;i<n;i++){
    setTimeout(()=>{
      const s=document.createElement('div');s.className='star-fall';
      s.textContent=STARS[Math.floor(Math.random()*STARS.length)];
      s.style.left=Math.random()*100+'vw';
      s.style.fontSize=(0.7+Math.random()*1.0)+'rem';
      const dur=2+Math.random()*2.5;s.style.animationDuration=dur+'s';
      document.body.appendChild(s);setTimeout(()=>s.remove(),(dur+0.3)*1000);
    },i*100);
  }
}

const noMsgs=[
  'Ø¨Ø³ Ù‚Ù„Ø¨Ùƒ ÙŠØ¹Ø±Ù Ø§Ù„Ø¬ÙˆØ§Ø¨.. ğŸŒ¸',
  'ØªØ¶Ù†ÙŠÙ† Ù„Ø§ØŸ ÙÙƒÙ‘Ø±ÙŠ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© ğŸ¤',
  'ÙŠØ§Ù…Ø§Ø¯Ø§ ÙŠØ­Ø¨Ùƒ Ø£ÙƒØ«Ø± Ù…Ù…Ø§ ØªØªØ®ÙŠÙ„ÙŠÙ† ğŸ’œ',
  'Ù„Ø§ØŸ Ø§Ù„Ø¸Ù„Ø§Ù… ÙŠØ¨Ø¯Ø£.. ğŸŒŒ',
  'Ù„Ùˆ Ø´ÙØªÙ Ù†ÙØ³Ùƒ Ù…Ù† Ø¹ÙŠÙ†ÙŠÙ‡ Ù„Ø¹Ø±ÙØªÙ ğŸ¥º',
  'ÙƒÙ„ Ù„Ø§.. ØªØ³ÙˆØ¯ Ø§Ù„Ø¯Ù†ÙŠØ§ Ø£ÙƒØ«Ø± ğŸŒ‘',
  'Ø´Ù‡Ø¯.. Ø§ÙÙƒØ±ÙŠ ğŸ’”',
  'ÙŠØ§Ù…Ø§Ø¯Ø§ ÙŠÙ†ØªØ¸Ø± Ø¬ÙˆØ§Ø¨Ùƒ Ø§Ù„ØµØ­..',
  'Ù…Ø§ Ø²Ù„ØªÙ ØªØ´ÙƒÙ‘ÙŠÙ†ØŸ ğŸ˜”',
  'Ø§Ù„Ø¸Ù„Ø§Ù… ÙŠÙ‚ØªØ±Ø¨.. ğŸŒš',
  'Ù‡Ùˆ ÙŠØ­Ø¨Ùƒ ÙŠØ§ Ø´Ù‡Ø¯.. ØµØ¯Ù‘Ù‚ÙŠ ğŸ’œ',
  'Ù‚Ù„Ø¨Ù‡ ÙŠØªØ£Ù„Ù… Ù…Ù† Ø´ÙƒÙ‘Ùƒ ğŸ’”',
  'Ø§Ù„Ø¯Ù†ÙŠØ§ Ø¨Ø¯ÙˆÙ†Ùƒ Ø³ÙˆØ¯Ø§Ø¡ Ø¨Ø¹ÙŠÙ†ÙŠÙ‡ ğŸ–¤',
  'Ù„Ø³Ø§ØŸ ğŸ˜®â€ğŸ’¨',
  'ÙƒÙ„ Ù…Ø§ Ù‚Ù„ØªÙ Ù„Ø§.. Ø²Ø§Ø¯ Ø§Ù„Ø£Ù„Ù… ğŸŒ§ï¸',
  'Ø´Ù‡Ø¯.. Ø£Ø±Ø¬ÙˆÙƒÙ ğŸŒ¹',
  'Ø§Ù„Ù†Ø¬ÙˆÙ… ØªØ³Ù‚Ø· ÙƒÙ„Ù…Ø§ Ø´ÙƒÙƒØªÙ ğŸ’«',
  'Ø­ØªÙ‰ Ø§Ù„Ù„ÙŠÙ„ ÙŠØ¨ÙƒÙŠ Ù…Ù† Ø´ÙƒÙ‘Ùƒ ğŸŒ‘',
  'Ø­Ø¨Ù‡ Ø£ÙƒØ¨Ø± Ù…Ù† ÙƒÙ„Ù…Ø© ğŸ˜­',
  'Ù‡Ùˆ ÙŠØ­Ø¨Ùƒ.. ÙˆØ§Ù„Ø¯Ù†ÙŠØ§ ØªØ¹Ø±Ù ğŸŒ¸',
  'ÙˆÙŠÙ† Ù…Ø§ Ø±ÙˆØ­ØªÙ.. Ù‡Ùˆ Ù‡Ù†Ø§Ùƒ ğŸ’­',
  'Ù…Ø§ ÙÙŠ Ø£Ø­Ø¯ ÙŠØ­Ø¨Ùƒ Ù…Ø«Ù„Ù‡ âœ¨',
  'Ù…Ø§ Ø±Ø§Ø­ ÙŠØªÙˆÙ‚Ù Ø¹Ù† Ø­Ø¨Ù‘Ùƒ ğŸ˜®â€ğŸ’¨',
  'ÙƒÙ„ Ø´Ùƒ ÙŠÙƒØ³Ø±Ù‡.. Ø¨Ø³ ÙŠØ¨Ù‚Ù‰ ÙŠØ­Ø¨ ğŸ’”',
  'Ù…Ø§ Ø²Ù„Øª Ù‡Ù†Ø§ Ø£Ù†ØªØ¸Ø± Ø¬ÙˆØ§Ø¨Ùƒ Ø§Ù„ØµØ­ ğŸŒ¹',
  'Ù…Ø§ Ø´ÙØª Ø£Ø­Ø¯ ØµØ¨Ø± Ù…Ø«Ù„Ù‡ ğŸ˜”',
  'Ø­ØªÙ‰ Ø§Ù„Ù„ÙŠÙ„ ØªØ¹Ø¨ Ù…Ù† Ø´ÙƒÙ‘Ùƒ ğŸŒš',
  'Ø´Ù‡Ø¯ Ù„Ùˆ ØªØ¹Ø±ÙÙŠÙ† ÙƒÙŠÙ ÙŠÙÙƒÙ‘Ø± ÙÙŠÙƒÙ.. ğŸ’­',
  'ÙƒÙ… Ù„Ø§ Ø¨Ù‚ØªØŸ ğŸ¥º',
  'Ø§Ù„Ø¬ÙˆØ§Ø¨ Ø§Ù„ØµØ­ ØªØ¹Ø±ÙÙŠÙ†Ù‡ ğŸŒ¸',
  'Ù‚Ù„Ø¨Ùƒ ÙŠØ®ØªÙ„Ù Ø¹Ù† Ù„Ø³Ø§Ù†Ùƒ ğŸ’“',
  'Ù‡Ùˆ Ù„Ø§ ÙŠØ£ÙƒÙ„ Ø¥Ù„Ø§ Ø¨ÙÙƒØ±Ùƒ ğŸ˜¤',
  'Ù‡Ùˆ Ù„Ø§ ÙŠÙ†Ø§Ù… Ø¥Ù„Ø§ Ø¨Ø°ÙƒØ±Ùƒ ğŸ˜¤',
  'ÙŠÙ†ØªØ¸Ø± Ù…Ù†Ùƒ Ù†Ø¹Ù… ğŸ•¯ï¸',
  'Ø¢Ø®Ø± Ø®Ù…Ø³ Ø¶ØºØ·Ø§Øª ğŸ‘€',
  'Ø£Ø±Ø¨Ø¹.. ğŸŒš',
  'Ø«Ù„Ø§Ø«.. ğŸ’”',
  'Ø«Ù†ØªÙŠÙ† Ø¨Ø§Ù„Ù„Ù‡ ğŸŒ‘',
  'ÙˆØ­Ø¯Ø© Ø¨Ø³.. ğŸ–¤',
  '..'
];

function darken(){
  noCount++;
  noBtn.classList.remove('shaking');void noBtn.offsetWidth;noBtn.classList.add('shaking');
  if(navigator.vibrate)navigator.vibrate(20+noCount*10);
  excuse.textContent=noMsgs[Math.min(noCount-1,noMsgs.length-1)];
  darkness.style.opacity=Math.min((noCount/MAX_NO)*0.7,0.7);

  // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø®Ø·Ø±
  const pct = Math.min(Math.round((noCount/MAX_NO)*100),100);
  const fill = document.getElementById('dangerFill');
  const dangerPct = document.getElementById('dangerPct');
  const qNum = document.getElementById('qNum');
  if(fill){ fill.style.width = pct+'%'; }
  if(dangerPct){ dangerPct.textContent = pct+'%'; }
  if(qNum){
    const arabic = ['Ù¡','Ù¢','Ù£','Ù¤','Ù¥','Ù¦','Ù§','Ù¨','Ù©','Ù¡Ù ','Ù¡Ù¡','Ù¡Ù¢','Ù¡Ù£','Ù¡Ù¤','Ù¡Ù¥','Ù¡Ù¦','Ù¡Ù§','Ù¡Ù¨','Ù¡Ù©','Ù¢Ù ','Ù¢Ù¡','Ù¢Ù¢','Ù¢Ù£','Ù¢Ù¤','Ù¢Ù¥','Ù¢Ù¦','Ù¢Ù§','Ù¢Ù¨','Ù¢Ù©','Ù£Ù ','Ù£Ù¡','Ù£Ù¢','Ù£Ù£','Ù£Ù¤','Ù£Ù¥','Ù£Ù¦','Ù£Ù§','Ù£Ù¨','Ù£Ù©','Ù¤Ù '];
    qNum.textContent = arabic[Math.min(noCount,39)];
  }
  if(noCount>=MAX_NO){
    darkPhase=true;noBtn.style.pointerEvents='none';
    darkness.style.transition='opacity 1.8s cubic-bezier(0.4,0,0.2,1)';
    darkness.style.opacity='1';
    setTimeout(()=>{
      mainCard.classList.add('fading');
      // Game Over screen
      const gameOverScreen = document.getElementById('gameOverScreen');
      gameOverScreen.classList.add('active');
      setTimeout(()=>{
        // Kali Linux screen
        gameOverScreen.style.transition='opacity 0.6s ease';
        gameOverScreen.style.opacity='0';
        setTimeout(()=>{gameOverScreen.classList.remove('active');gameOverScreen.style.opacity='';gameOverScreen.style.transition='';},700);
        startKaliScreen(()=>{
          startHacker();
        });
      },2800);
    },800);
  }
}

const POEM_TEXT='ÙˆÙÙ„ÙÙˆ Ø³ÙÙ‚ÙØ·ÙØª Ù†ÙØ¬ÙˆÙ…Ù Ø§Ù„Ø³ÙÙ‘Ù…Ø§Ø¡Ù ÙƒÙÙ„ÙÙ‘Ù‡Ø§\nÙ„ÙÙ…Ø§ Ø²Ø§Ù„Ù Ø­ÙØ¨ÙÙ‘ÙŠ Ù„ÙÙƒÙ ğŸŒ¸âœ¨';

function startDarkScene(){
  darkScene.classList.add('visible');
  // 1. GIF
  setTimeout(()=>{
    darkGif1.classList.add('show');
    // 2. Ø§Ù„Ù†Øµ ÙŠÙÙƒØªØ¨ Ø£ÙˆÙ„Ø§Ù‹
    setTimeout(()=>{
      typePoem(POEM_TEXT,()=>{
        // 3. Ù†Ø§ÙØ°Ø© Windows Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ù†Øµ
        setTimeout(()=>{
          winDialog.classList.add('show');
          startFireflies();
        },700);
      });
    },800);
  },600);
}

function typePoem(text,onDone){
  darkPoem.innerHTML='';
  const lines=text.split('\n');let li=0,ci=0;
  const cursor=document.createElement('span');cursor.className='cursor';
  darkPoem.appendChild(cursor);
  function next(){
    if(li>=lines.length){cursor.remove();if(onDone)onDone();return;}
    const line=lines[li];
    if(ci<line.length){
      const ch=document.createElement('span');ch.textContent=line[ci];
      darkPoem.insertBefore(ch,cursor);ci++;
      const c=line[ci-1];
      setTimeout(next,c===','||c==='.'||c==='!'?180:c===' '?55:80);
    } else {
      li++;ci=0;
      if(li<lines.length){darkPoem.insertBefore(document.createElement('br'),cursor);setTimeout(next,500);}
      else{cursor.remove();if(onDone)onDone();}
    }
  }
  next();
}

function startFireflies(){
  const spawnFF=()=>{
    if(gameOver)return;
    const ff=document.createElement('div');ff.className='firefly';
    const angle=Math.random()*Math.PI*2,r=80+Math.random()*160;
    ff.style.setProperty('--fx',Math.cos(angle)*r+'px');
    ff.style.setProperty('--fy',Math.sin(angle)*r+'px');
    const dur=2+Math.random()*3;ff.style.animationDuration=dur+'s';
    ff.style.animationDelay=(Math.random()*1.5)+'s';
    const br=winDialog.getBoundingClientRect();
    ff.style.left=(br.left+br.width/2-3+(Math.random()-0.5)*80)+'px';
    ff.style.top=(br.top+br.height/2-3+(Math.random()-0.5)*60)+'px';
    document.body.appendChild(ff);
    setTimeout(()=>{if(ff.parentNode)ff.remove();},dur*1000+1500);
  };
  for(let i=0;i<10;i++)setTimeout(spawnFF,i*250);
  const iv=setInterval(()=>{if(gameOver){clearInterval(iv);return;}spawnFF();},350);
}

darkYesBtn.addEventListener('click',startHacker);

function buildHackerBg(){
  const chars='01ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªabcdefABCDEFâ™¥â˜…Î±Î²Î³Î´'.split('');
  const cols=Math.floor(W/22);
  for(let i=0;i<cols;i++){
    const col=document.createElement('div');col.className='hacker-col';
    col.style.left=(i*22)+'px';
    col.style.animationDuration=(3+Math.random()*6)+'s';
    col.style.animationDelay=(-Math.random()*6)+'s';
    let txt='';for(let j=0;j<30;j++)txt+=chars[Math.floor(Math.random()*chars.length)]+'\n';
    col.textContent=txt;hackerBg.appendChild(col);
  }
}

function startKaliScreen(onDone){
  const kaliScreen = document.getElementById('kaliScreen');
  const kaliLines = document.getElementById('kaliLines');
  const kaliClock = document.getElementById('kaliClock');

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø©
  const clockIv = setInterval(()=>{
    const now = new Date();
    kaliClock.textContent = now.getHours().toString().padStart(2,'0')+':'+now.getMinutes().toString().padStart(2,'0');
  },1000);
  kaliClock.textContent = new Date().getHours().toString().padStart(2,'0')+':'+new Date().getMinutes().toString().padStart(2,'0');

  kaliScreen.classList.add('active');

  const lines = [
    {t:'prompt', txt:'root@kali:~# python3 end_game.py --target shohd'},
    {t:'dim',    txt:'[*] Loading game termination module...'},
    {t:'dim',    txt:'[*] Connecting to target device...'},
    {t:'white',  txt:'[+] Connection established.'},
    {t:'prompt', txt:'root@kali:~# ./terminate_game.sh'},
    {t:'warning',txt:'[!] WARNING: Game state corrupted'},
    {t:'error',  txt:'[ERROR] Ø§Ù„Ù†Ø¸Ø§Ù… ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©'},
    {t:'error',  txt:'[ERROR] ÙŠØ¨Ø¯Ùˆ Ø£Ù†Ù‡ ÙŠÙˆØ¬Ø¯ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹'},
    {t:'dim',    txt:'[*] Stack trace:'},
    {t:'dim',    txt:'    â†’ love_module.py:404 â€” LoveNotFound'},
    {t:'dim',    txt:'    â†’ heart_core.dll â€” HeartOverflow Exception'},
    {t:'warning',txt:'[!] Segmentation fault (core dumped)'},
    {t:'error',  txt:'[CRITICAL] Cannot terminate what was never a game...'},
    {t:'white',  txt:'[*] Initiating YAMADA_BREACH protocol instead...'},
  ];

  let i = 0;
  function addKaliLine(){
    if(i >= lines.length){
      clearInterval(clockIv);
      setTimeout(()=>{
        kaliScreen.style.transition='opacity 0.5s ease';
        kaliScreen.style.opacity='0';
        setTimeout(()=>{kaliScreen.classList.remove('active');kaliScreen.style.opacity='';kaliScreen.style.transition='';if(onDone)onDone();},600);
      },800);
      return;
    }
    const l = document.createElement('span');
    l.className = 'kali-line ' + lines[i].t;
    l.textContent = lines[i].txt;
    kaliLines.appendChild(l);
    kaliLines.scrollTop = kaliLines.scrollHeight;
    i++;
    setTimeout(addKaliLine, 200 + Math.random()*150);
  }
  addKaliLine();
}

function startHacker(){
  if(!gameOver){gameOver=true;}
  darkScene.style.transition='opacity 0.4s ease';
  darkScene.style.opacity='0';darkScene.style.pointerEvents='none';

  const termLines = document.getElementById('termLines');
  const breachBanner = document.getElementById('breachBanner');

  const lines = [
    {t:'dim',  txt:'[SYS] Initializing breach protocol...'},
    {t:'',     txt:'> Scanning target: shohd_device_v1'},
    {t:'yellow',txt:'[WARN] Firewall detected. Bypassing...'},
    {t:'',     txt:'> Injecting payload 0xYAMADA_4F2A'},
    {t:'dim',  txt:'[...] Cracking encryption layer 1/3'},
    {t:'dim',  txt:'[...] Cracking encryption layer 2/3'},
    {t:'dim',  txt:'[...] Cracking encryption layer 3/3 âœ“'},
    {t:'',     txt:'> Accessing private memory...'},
    {t:'yellow',txt:'[DATA] Found: 1 hidden folder â†’ "Ø´Ù‡Ø¯"'},
    {t:'',     txt:'> Extracting feelings_core.dll'},
    {t:'red',  txt:'[!!!] SECURITY BREACH â€” YAMADA IS IN'},
    {t:'white', txt:'> Target breached successfully. ğŸ’œ'},
  ];

  setTimeout(()=>{
    hackerScreen.classList.add('active');
    buildHackerBg();

    let i = 0;
    function addLine(){
      if(i >= lines.length){
        // BREACHED
        setTimeout(()=>{
          breachBanner.classList.add('show');
          // Ø§Ù‡ØªØ²Ø§Ø² Ø´Ø§Ø´Ø©
          hackerScreen.style.animation='glitch 0.1s steps(1) 5';
          setTimeout(()=>{
            hackerScreen.style.animation='';
            // ØµÙˆØ±Ø© + I love you
            setTimeout(()=>{
              hackerPng.classList.add('show');
              setTimeout(()=>{
                typeHacker('I love you',()=>{setTimeout(goPoem,2200);});
              },600);
            },600);
          },600);
        },400);
        return;
      }
      const l = document.createElement('span');
      l.className = 'term-line ' + lines[i].t;
      l.textContent = lines[i].txt;
      termLines.appendChild(l);
      termLines.scrollTop = termLines.scrollHeight;
      i++;
      setTimeout(addLine, 180 + Math.random()*120);
    }
    addLine();
  },400);
}

function typeHacker(text,onDone){
  const chars='01#@$%&*!?ABCDEFabcdef'.split('');
  let revealed=Array(text.length).fill(false);
  let displayArr=Array(text.length).fill('_');
  hackerText.textContent=displayArr.join('');
  text.split('').forEach((finalChar,idx)=>{
    if(finalChar===' '){revealed[idx]=true;displayArr[idx]=' ';return;}
    let scrambles=0;const delay=idx*180;
    setTimeout(()=>{
      const scrambleIv=setInterval(()=>{
        displayArr[idx]=chars[Math.floor(Math.random()*chars.length)];
        hackerText.textContent=displayArr.join('');scrambles++;
        if(scrambles>=6){
          clearInterval(scrambleIv);displayArr[idx]=finalChar;revealed[idx]=true;
          hackerText.textContent=displayArr.join('');
          if(revealed.every(r=>r)&&onDone)setTimeout(onDone,400);
        }
      },60);
    },delay);
  });
}

function goPoem(){
  hackerScreen.style.transition='opacity 0.9s ease';
  hackerScreen.style.opacity='0';
  darkness.style.transition='opacity 0.8s ease';
  darkness.style.opacity='0';
  setTimeout(()=>{
    hackerScreen.classList.remove('active');
    mainCard.classList.remove('fading');
    mainCard.classList.add('poem-mode');
    // Ø£Ø®ÙÙ Ø§Ù„Ø¸Ù„Ø§Ù… ØªÙ…Ø§Ù…Ø§Ù‹ Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØºØ·ÙŠ Ø§Ù„ÙƒØ§Ø±Øª
    darkness.style.pointerEvents='none';
    darkness.style.display='none';
    document.getElementById('pg1').classList.remove('on');
    const pg3=document.getElementById('pg3');
    pg3.classList.add('on');
    pg3.scrollTop=0;
    const pv=document.getElementById('poemVideo');
    if(pv){pv.play().catch(()=>{});}
  },950);
}

/* NO CLICK */
let noCooldown = false;
noBtn.addEventListener('click',()=>{
  if(gameOver||darkPhase) return;
  if(noCooldown) return;
  noCooldown = true;
  setTimeout(()=>{ noCooldown = false; }, 1000);
  darken();
});

/* THE END */
document.getElementById('theEndBtn').addEventListener('click', goEnd);

function goEnd(){
  [introSong,gameSong].forEach(a=>{try{a.pause();a.currentTime=0;}catch(e){}});

  const eu        = document.getElementById('endUniverse');
  const endBlack  = document.getElementById('endBlack');
  const errCont   = document.getElementById('errorContainer');
  const lovePop   = document.getElementById('lovePop');
  const lpYes     = document.getElementById('lpYes');
  const lpNo      = document.getElementById('lpNo');
  const hackMsg   = document.getElementById('hackMsg');
  const finalVid  = document.getElementById('finalVid');

  eu.classList.add('active');
  requestAnimationFrame(()=>{ endBlack.classList.add('show'); });

  // â”€â”€ error messages â”€â”€ 3 ÙÙ‚Ø· ÙˆØ³Ø±ÙŠØ¹Ø©
  const ERRORS = [
    { title:'System Error',     msg:'Fatal exception 0xDEAD_LOVE\nApplication will terminate.' },
    { title:'Critical Warning', msg:'Unknown feelings packet\nentered the system.\nCannot block.' },
    { title:'Kernel Panic',     msg:'loveDLL.dll is corrupted.\nReinstalling yamada.exe...' },
  ];

  const W = window.innerWidth, H = window.innerHeight;
  const positions = [
    {x:W*0.05, y:H*0.08},
    {x:W*0.38, y:H*0.35},
    {x:W*0.10, y:H*0.58},
  ];

  function makeError(i){
    const e = ERRORS[i];
    const div = document.createElement('div');
    div.className = 'err-pop';
    div.style.left = (positions[i].x) + 'px';
    div.style.top  = (positions[i].y) + 'px';
    div.innerHTML = `
      <div class="err-bar">
        <span>âš  ${e.title}</span>
        <div class="err-bar-btns">
          <div class="err-bar-btn">_</div>
          <div class="err-bar-btn">â–¡</div>
          <div class="err-bar-btn">âœ•</div>
        </div>
      </div>
      <div class="err-body">
        <div class="err-row">
          <span class="err-icon">ğŸ›‘</span>
          <span class="err-txt">${e.msg.replace(/\n/g,'<br>')}</span>
        </div>
        <button class="err-ok">OK</button>
      </div>`;
    errCont.appendChild(div);
  }

  // drop errors one by one
  let ei = 0;
  function dropErr(){
    if(ei < ERRORS.length){
      makeError(ei); ei++;
      setTimeout(dropErr, 280);
    } else {
      // show love popup after last error
      setTimeout(()=>{
        lovePop.style.display = 'flex';
        requestAnimationFrame(()=>{ lovePop.classList.add('show'); });

        // NO btn â†’ disappears after 3 seconds automatically, or on click
        let noTimer = setTimeout(()=>{ lpNo.classList.add('hide'); }, 3000);
        lpNo.addEventListener('click', ()=>{
          clearTimeout(noTimer);
          lpNo.classList.add('hide');
        });

        // YES btn
        lpYes.addEventListener('click', ()=>{
          // hide everything
          lovePop.classList.remove('show');
          errCont.innerHTML = '';
          setTimeout(()=>{
            lovePop.style.display = 'none';
            // type hacker text
            hackMsg.classList.add('show');
            typeHackerMsg('I love you too, my life', ()=>{
            // after typing, show flip screen then video
              setTimeout(()=>{
                hackMsg.style.transition = 'opacity 1s ease';
                hackMsg.style.opacity = '0';
                const flipScreen = document.getElementById('flipScreen');
                setTimeout(()=>{
                  flipScreen.classList.add('show');
                  // after 3 seconds start video
                  setTimeout(()=>{
                    flipScreen.style.transition = 'opacity 0.8s ease';
                    flipScreen.style.opacity = '0';
                    // start video properly
                    finalVid.muted = false;
                    finalVid.volume = 1;
                    finalVid.load();
                    const tryPlay = ()=>{
                      finalVid.play().then(()=>{
                        setTimeout(()=>{ finalVid.classList.add('show'); }, 300);
                      }).catch(()=>{
                        finalVid.muted = true;
                        finalVid.play().then(()=>{ setTimeout(()=>{ finalVid.classList.add('show'); },300); }).catch(()=>{});
                      });
                    };
                    finalVid.addEventListener('canplay', tryPlay, {once:true});
                    setTimeout(tryPlay, 1500); // fallback
                  }, 3200);
                }, 600);
              }, 1800);
            });
          }, 600);
        });
      }, 500);
    }
  }

  setTimeout(dropErr, 900);
}

function typeHackerMsg(text, onDone){
  const el = document.getElementById('hmMain');
  el.textContent = '';
  const chars = '01#@$%â™¥â˜…âœ¦âˆâˆ…âˆ†Î©'.split('');
  let displayArr = Array(text.length).fill('_');
  let revealed = Array(text.length).fill(false);
  el.textContent = displayArr.join('');

  text.split('').forEach((finalChar, idx)=>{
    if(finalChar === ' '){ revealed[idx]=true; displayArr[idx]=' '; return; }
    const delay = idx * 110;
    setTimeout(()=>{
      let scrambles = 0;
      const iv = setInterval(()=>{
        displayArr[idx] = chars[Math.floor(Math.random()*chars.length)];
        el.textContent = displayArr.join('');
        scrambles++;
        if(scrambles >= 6){
          clearInterval(iv);
          displayArr[idx] = finalChar;
          revealed[idx] = true;
          el.textContent = displayArr.join('');
          if(revealed.every(r=>r) && onDone) setTimeout(onDone, 300);
        }
      }, 45);
    }, delay);
  });
}
</script>
</body>
</html>
